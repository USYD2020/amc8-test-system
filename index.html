<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMC8 ç­å‰æµ‹è¯•ç³»ç»Ÿ</title>
    
    <!-- å¤–éƒ¨èµ„æº -->
    <link href="https://cdn.staticfile.org/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.staticfile.org/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Supabase Client Library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #1e40af;
            --accent-color: #f59e0b;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --dark-bg: #1f2937;
            --dark-card: #374151;
        }

        * {
            font-family: 'Noto Sans SC', Tahoma, Arial, Roboto, "Droid Sans", "Helvetica Neue", "Droid Sans Fallback", "Heiti SC", "Hiragino Sans GB", Simsun, sans-serif;
        }

        body {
            transition: all 0.3s ease;
        }

        .hero-gradient {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
        }

        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.5);
        }

        /* æ·±è‰²æ¨¡å¼æ ·å¼ */
        .dark {
            background-color: var(--dark-bg);
            color: #f9fafb;
        }

        .dark .bg-white {
            background-color: var(--dark-card) !important;
        }

        .dark .text-gray-900 {
            color: #f9fafb !important;
        }

        .dark .text-gray-600 {
            color: #9ca3af !important;
        }

        .dark .border-gray-200 {
            border-color: #4b5563 !important;
        }

        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in-up {
            animation: fadeInUp 0.8s ease-out;
        }

        .animate-delay-200 {
            animation-delay: 0.2s;
        }

        .animate-delay-400 {
            animation-delay: 0.4s;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- å¯¼èˆªæ  -->
    <nav class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-calculator text-white text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-900">AMC8 ç­å‰æµ‹è¯•ç³»ç»Ÿ</h1>
                        <p class="text-sm text-gray-500">Jeffè€å¸ˆæ•°å­¦èƒ½åŠ›è¯„ä¼°</p>
                    </div>
                </div>
                
                <!-- æ·±è‰²æ¨¡å¼åˆ‡æ¢ -->
                <button id="theme-toggle" class="p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors">
                    <i class="fas fa-moon text-gray-600"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- ä¸»è¦å†…å®¹ -->
    <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <!-- Hero åŒºåŸŸ -->
        <div class="hero-gradient rounded-3xl p-8 md:p-12 text-white mb-12 animate-fade-in-up">
            <div class="text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-white bg-opacity-20 rounded-full mb-6">
                    <i class="fas fa-graduation-cap text-2xl"></i>
                </div>
                <h1 class="text-4xl md:text-5xl font-bold mb-4">AMC8 ç­å‰èƒ½åŠ›æµ‹è¯•</h1>
                <p class="text-xl md:text-2xl mb-6 text-blue-100">ä¸“ä¸šæ•°å­¦ç«èµ›æ°´å¹³è¯„ä¼°ï¼Œç²¾å‡†ç­å‹æ¨è</p>
                <div class="flex flex-wrap justify-center gap-6 text-sm">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-clock"></i>
                        <span>75åˆ†é’Ÿé™æ—¶</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-list-ol"></i>
                        <span>25é“é¢˜ç›®</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-trophy"></i>
                        <span>æ™ºèƒ½è¯„åˆ†</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- æµ‹è¯•è¯´æ˜å¡ç‰‡ -->
        <div class="grid md:grid-cols-2 gap-8 mb-12">
            <!-- æµ‹è¯•è§„åˆ™ -->
            <div class="bg-white rounded-2xl p-6 shadow-lg card-hover animate-fade-in-up animate-delay-200">
                <div class="flex items-center space-x-3 mb-4">
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-info-circle text-blue-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900">æµ‹è¯•è§„åˆ™</h3>
                </div>
                <ul class="space-y-3 text-gray-600">
                    <li class="flex items-start space-x-3">
                        <i class="fas fa-check-circle text-green-500 mt-1 text-sm"></i>
                        <span>æ€»è®¡25é“é€‰æ‹©é¢˜ï¼Œæ¯é¢˜1åˆ†ï¼Œæ»¡åˆ†25åˆ†</span>
                    </li>
                    <li class="flex items-start space-x-3">
                        <i class="fas fa-check-circle text-green-500 mt-1 text-sm"></i>
                        <span>ç­”å¯¹å¾—1åˆ†ï¼Œç­”é”™æˆ–ä¸ç­”å¾—0åˆ†</span>
                    </li>
                    <li class="flex items-start space-x-3">
                        <i class="fas fa-check-circle text-green-500 mt-1 text-sm"></i>
                        <span>è€ƒè¯•æ—¶é—´75åˆ†é’Ÿï¼Œæ—¶é—´åˆ°è‡ªåŠ¨æäº¤</span>
                    </li>
                    <li class="flex items-start space-x-3">
                        <i class="fas fa-check-circle text-green-500 mt-1 text-sm"></i>
                        <span>æ”¯æŒéšæ—¶ä¿å­˜ç­”æ¡ˆï¼Œé˜²æ­¢æ„å¤–ä¸¢å¤±</span>
                    </li>
                </ul>
            </div>

            <!-- ç­å‹ä»‹ç» -->
            <div class="bg-white rounded-2xl p-6 shadow-lg card-hover animate-fade-in-up animate-delay-400">
                <div class="flex items-center space-x-3 mb-4">
                    <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                        <i class="fas fa-layer-group text-purple-600 text-xl"></i>
                    </div>
                    <h3 class="text-xl font-bold text-gray-900">ç­å‹æ¨è</h3>
                </div>
                <div class="space-y-3">
                    <div class="flex justify-between items-center p-3 bg-red-50 rounded-lg">
                        <span class="font-medium text-red-700">åŸºç¡€ç­ å‡†å¤‡ 1 å¹´</span>
                        <span class="text-sm text-red-600">1-4é¢˜</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-yellow-50 rounded-lg">
                        <span class="font-medium text-orange-700">æ½œåŠ›ç­ å‡†å¤‡ 1 å¹´</span>
                        <span class="text-sm text-gray-900">5-7é¢˜</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-blue-50 rounded-lg">
                        <span class="font-medium text-blue-700">å¼ºåŒ–ç­</span>
                        <span class="text-sm text-blue-600">8-10é¢˜</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-purple-50 rounded-lg">
                        <span class="font-medium text-purple-700">å¼ºåŒ–ç­+</span>
                        <span class="text-sm text-purple-600">11-13é¢˜</span>
                    </div>
                    <div class="flex justify-between items-center p-3 bg-green-50 rounded-lg">
                        <span class="font-medium text-green-700">å»ºè®®å¼•å¯¼ AMC10 + å¼ºåŒ–ç­(ä¸“æ³¨å†²åˆº)</span>
                        <span class="text-sm text-green-600">14é¢˜ä»¥ä¸Š</span>
                    </div>
                </div>
                </div>
            </div>
        </div>

        <!-- ç”¨æˆ·ä¿¡æ¯è¡¨å• -->
        <div class="bg-white rounded-2xl p-8 shadow-lg max-w-2xl mx-auto">
            <h2 class="text-2xl font-bold text-gray-900 mb-4 text-center">å¼€å§‹ä½ çš„AMC8ä¹‹æ—…</h2>
            
            <!-- æµ‹è¯•æ¨¡å¼åˆ‡æ¢ (å¼€å‘è€…ä¸“ç”¨ï¼Œé»˜è®¤éšè—) -->
            <div id="test-mode-toggle-container" class="flex justify-center mb-6" style="display: none;">
                <button type="button" id="test-mode-toggle" 
                        class="px-4 py-2 text-sm bg-yellow-100 hover:bg-yellow-200 text-yellow-700 rounded-lg transition-all border-2 border-yellow-300">
                    <i class="fas fa-flask mr-2"></i>ğŸ§ª å¼€å‘è€…æµ‹è¯•æ¨¡å¼
                </button>
            </div>
            
            <form id="start-test-form" class="space-y-6">
                <div>
                    <label for="student-name" class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-user mr-2"></i>å­¦ç”Ÿå§“å
                    </label>
                    <input type="text" 
                           id="student-name" 
                           required
                           placeholder="è¯·è¾“å…¥å­¦ç”Ÿå§“å"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                </div>

                <div>
                    <label for="student-phone" class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-phone mr-2"></i>è”ç³»ç”µè¯
                    </label>
                    <input type="tel" 
                           id="student-phone"
                           required
                           placeholder="è¯·è¾“å…¥è”ç³»ç”µè¯"
                           pattern="[0-9]{11}"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                </div>

                <div>
                    <label for="student-grade" class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-graduation-cap mr-2"></i>å¹´çº§
                    </label>
                    <select id="student-grade" 
                            required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        <option value="">è¯·é€‰æ‹©å¹´çº§</option>
                        <option value="3å¹´çº§ä»¥ä¸‹">3å¹´çº§ä»¥ä¸‹</option>
                        <option value="3">3å¹´çº§</option>
                        <option value="4">4å¹´çº§</option>
                        <option value="5">5å¹´çº§</option>
                        <option value="6">6å¹´çº§</option>
                        <option value="7">7å¹´çº§</option>
                        <option value="8">8å¹´çº§</option>
                        <option value="8å¹´çº§ä»¥ä¸Š">8å¹´çº§ä»¥ä¸Š</option>
                    </select>
                </div>

                <!-- ç¡®è®¤æ¡æ¬¾ -->
                <div class="flex items-start space-x-3">
                    <input type="checkbox" 
                           id="agree-terms" 
                           required
                           class="mt-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                    <label for="agree-terms" class="text-sm text-gray-600">
                        æˆ‘å·²é˜…è¯»å¹¶åŒæ„æµ‹è¯•è§„åˆ™ï¼Œäº†è§£æœ¬æ¬¡æµ‹è¯•ä¸ºå­¦æœ¯è¯„ä¼°ç›®çš„ï¼Œç¡®ä¿ç‹¬ç«‹å®Œæˆæµ‹è¯•
                    </label>
                </div>

                <!-- å¼€å§‹æŒ‰é’® -->
                <button type="submit" 
                        class="w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white py-4 px-6 rounded-lg font-semibold text-lg btn-primary">
                    <i class="fas fa-play mr-2"></i>å¼€å§‹æµ‹è¯•
                </button>
            </form>

            <!-- æµ‹è¯•æ¨¡å¼è¡¨å• (é»˜è®¤éšè—) -->
            <form id="test-mode-form" class="space-y-6" style="display: none;">
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                    <div class="flex items-center">
                        <i class="fas fa-flask text-yellow-600 mr-2"></i>
                        <span class="text-yellow-800 font-medium">æµ‹è¯•æ¨¡å¼å·²å¯ç”¨</span>
                    </div>
                    <p class="text-sm text-yellow-700 mt-1">åœ¨æ­¤æ¨¡å¼ä¸‹å¯ä»¥è¾“å…¥æ¨¡æ‹Ÿç”¨æˆ·ä¿¡æ¯å’Œéšæœºç­”æ¡ˆæ¥æµ‹è¯•ç³»ç»ŸåŠŸèƒ½</p>
                </div>

                <!-- æµ‹è¯•ç”¨æˆ·ä¿¡æ¯ -->
                <div>
                    <label for="test-student-name" class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-user mr-2"></i>æµ‹è¯•å­¦ç”Ÿå§“å
                    </label>
                    <input type="text" 
                           id="test-student-name" 
                           value="å¼ ä¸‰æµ‹è¯•"
                           placeholder="è¯·è¾“å…¥æµ‹è¯•å­¦ç”Ÿå§“å"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                </div>

                <div>
                    <label for="test-student-phone" class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-phone mr-2"></i>æµ‹è¯•è”ç³»ç”µè¯
                    </label>
                    <input type="tel" 
                           id="test-student-phone"
                           value="13800138000"
                           placeholder="è¯·è¾“å…¥æµ‹è¯•è”ç³»ç”µè¯"
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                </div>

                <div>
                    <label for="test-student-grade" class="block text-sm font-medium text-gray-700 mb-2">
                        <i class="fas fa-graduation-cap mr-2"></i>æµ‹è¯•å¹´çº§
                    </label>
                    <select id="test-student-grade" 
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        <option value="4" selected>4å¹´çº§</option>
                        <option value="3å¹´çº§ä»¥ä¸‹">3å¹´çº§ä»¥ä¸‹</option>
                        <option value="3">3å¹´çº§</option>
                        <option value="5">5å¹´çº§</option>
                        <option value="6">6å¹´çº§</option>
                        <option value="7">7å¹´çº§</option>
                        <option value="8">8å¹´çº§</option>
                        <option value="8å¹´çº§ä»¥ä¸Š">8å¹´çº§ä»¥ä¸Š</option>
                    </select>
                </div>

                <!-- ç­”æ¡ˆç”Ÿæˆé€‰é¡¹ -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <h3 class="font-medium text-blue-900 mb-3">
                        <i class="fas fa-magic mr-2"></i>ç­”æ¡ˆç”Ÿæˆè®¾ç½®
                    </h3>
                    <div class="space-y-3">
                        <div>
                            <label for="answer-mode" class="block text-sm font-medium text-gray-700 mb-2">ç­”æ¡ˆæ¨¡å¼</label>
                            <select id="answer-mode" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="random">éšæœºç­”æ¡ˆ</option>
                                <option value="mostly-correct">å¤§éƒ¨åˆ†æ­£ç¡® (80%)</option>
                                <option value="mostly-wrong">å¤§éƒ¨åˆ†é”™è¯¯ (20%)</option>
                                <option value="all-correct">å…¨éƒ¨æ­£ç¡®</option>
                                <option value="all-wrong">å…¨éƒ¨é”™è¯¯</option>
                                <option value="no-answers">å…¨éƒ¨ä¸ç­” (æµ‹è¯•0ç­”æ¡ˆåœºæ™¯)</option>
                                <option value="pattern">æœ‰è§„å¾‹çš„ç­”æ¡ˆ (A-B-C-D-Eå¾ªç¯)</option>
                            </select>
                        </div>
                        <div>
                            <label for="answer-count" class="block text-sm font-medium text-gray-700 mb-2">ç­”é¢˜æ•°é‡</label>
                            <select id="answer-count" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="25">å®Œæ•´ç­”é¢˜ (25é¢˜)</option>
                                <option value="20">å¤§éƒ¨åˆ†ç­”é¢˜ (20é¢˜)</option>
                                <option value="15">éƒ¨åˆ†ç­”é¢˜ (15é¢˜)</option>
                                <option value="10">å°‘é‡ç­”é¢˜ (10é¢˜)</option>
                                <option value="5">æå°‘ç­”é¢˜ (5é¢˜)</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- å¼€å§‹æµ‹è¯•æŒ‰é’® -->
                <button type="submit" 
                        class="w-full bg-gradient-to-r from-yellow-500 to-orange-500 text-white py-4 px-6 rounded-lg font-semibold text-lg hover:from-yellow-600 hover:to-orange-600 transition-all">
                    <i class="fas fa-flask mr-2"></i>å¼€å§‹æµ‹è¯•æ¨¡å¼
                </button>
            </form>
        </div>

        <!-- ç‰¹è‰²åŠŸèƒ½ -->
        <div class="mt-16">
            <h2 class="text-2xl font-bold text-center text-gray-900 mb-8">ç³»ç»Ÿç‰¹è‰²</h2>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="bg-white p-6 rounded-xl shadow-md text-center card-hover">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-brain text-blue-600 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-semibold mb-2">æ™ºèƒ½åˆ†æ</h3>
                    <p class="text-gray-600 text-sm">AIé©±åŠ¨çš„èƒ½åŠ›åˆ†æï¼Œç²¾å‡†è¯†åˆ«æ•°å­¦å¼ºå¼±é¡¹</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md text-center card-hover">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-chart-line text-green-600 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-semibold mb-2">è¯¦ç»†æŠ¥å‘Š</h3>
                    <p class="text-gray-600 text-sm">å…¨æ–¹ä½æˆç»©åˆ†ææŠ¥å‘Šï¼Œå¯è§†åŒ–èƒ½åŠ›é›·è¾¾å›¾</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md text-center card-hover">
                    <div class="w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-download text-purple-600 text-2xl"></i>
                    </div>
                    <h3 class="text-lg font-semibold mb-2">ç»“æœå¯¼å‡º</h3>
                    <p class="text-gray-600 text-sm">æ”¯æŒPDFå¯¼å‡ºï¼Œæ°¸ä¹…ä¿å­˜æµ‹è¯•ç»“æœ</p>
                </div>
            </div>
        </div>
    </main>

    <!-- é¡µè„š -->
    <footer class="bg-gray-900 text-white py-8 mt-16">
        <div class="max-w-4xl mx-auto px-4 text-center">
            <div class="flex items-center justify-center space-x-3 mb-4">
                <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center">
                    <i class="fas fa-calculator text-white text-sm"></i>
                </div>
                <span class="font-semibold">AMC8 ç­å‰æµ‹è¯•ç³»ç»Ÿ</span>
            </div>
            <p class="text-gray-400 mb-2">Â© 2025 Jeffè€å¸ˆ. AMCæ•°å­¦ç«èµ›ä¸“ä¸šåŸ¹è®­.</p>
            <p class="text-gray-500 text-sm">æœ¬ç³»ç»Ÿä»…ç”¨äºæ•™å­¦è¯„ä¼°ç›®çš„</p>
        </div>
    </footer>

    <!-- Supabase Database Operations -->
    <script src="assets/js/supabase-client.js"></script>
    
    <script>
        // æ·±è‰²æ¨¡å¼åˆ‡æ¢
        const themeToggle = document.getElementById('theme-toggle');
        const body = document.body;
        const themeIcon = themeToggle.querySelector('i');

        // æ£€æŸ¥æœ¬åœ°å­˜å‚¨çš„ä¸»é¢˜è®¾ç½®
        const currentTheme = localStorage.getItem('theme') || 
                           (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        
        if (currentTheme === 'dark') {
            body.classList.add('dark');
            themeIcon.classList.replace('fa-moon', 'fa-sun');
        }

        themeToggle.addEventListener('click', () => {
            body.classList.toggle('dark');
            
            if (body.classList.contains('dark')) {
                localStorage.setItem('theme', 'dark');
                themeIcon.classList.replace('fa-moon', 'fa-sun');
            } else {
                localStorage.setItem('theme', 'light');
                themeIcon.classList.replace('fa-sun', 'fa-moon');
            }
        });

        // è¡¨å•æäº¤å¤„ç†
        document.getElementById('start-test-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            // ç¡®ä¿è¿™æ˜¯æ­£å¸¸è¡¨å•æäº¤ï¼Œä¸æ˜¯æµ‹è¯•æ¨¡å¼
            if (testModeActivated || isTestMode || window.testModeActive) {
                console.log('é˜»æ­¢äº†æµ‹è¯•æ¨¡å¼ä¸‹çš„æ­£å¸¸è¡¨å•æäº¤');
                return;
            }
            
            // å¼ºåˆ¶ç¡®ä¿æˆ‘ä»¬ä½¿ç”¨æ­£å¸¸è¡¨å•çš„å€¼
            console.log('æ­£å¸¸è¡¨å•æäº¤å¼€å§‹...');
            
            const submitButton = e.target.querySelector('button[type="submit"]');
            const originalText = submitButton.innerHTML;
            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>å¤„ç†ä¸­...';
            
            // å®Œå…¨æ¸…é™¤ä»»ä½•æµ‹è¯•æ¨¡å¼æ•°æ®ï¼ˆé˜²æ­¢æ„å¤–è¦†ç›–ï¼‰
            const testKeys = ['amc8_test_mode', 'amc8_test_completed', 'amc8_test_answers', 'amc8_test_time'];
            testKeys.forEach(key => localStorage.removeItem(key));
            
            // ä¸´æ—¶ç¦ç”¨æµ‹è¯•æ¨¡å¼æ¿€æ´»
            window.testModeDisabled = true;
            
            console.log('å·²æ¸…é™¤æ‰€æœ‰æµ‹è¯•æ¨¡å¼æ•°æ®ï¼Œå¼€å§‹æ­£å¸¸è¡¨å•æäº¤');
            
            // æ£€æŸ¥æ˜¯å¦è·³è¿‡æ•°æ®åº“æ“ä½œï¼ˆæœ¬åœ°æµ‹è¯•æ¨¡å¼ï¼‰
            const skipDatabase = window.location.search.includes('local=true') || window.location.hostname === 'localhost';
            
            const studentName = document.getElementById('student-name').value.trim();
            const studentPhone = document.getElementById('student-phone').value.trim();
            const studentGrade = document.getElementById('student-grade').value;
            
            // Debug: è¾“å‡ºç”¨æˆ·è¾“å…¥ä¿¡æ¯
            console.log('ç”¨æˆ·è¾“å…¥ä¿¡æ¯:', { name: studentName, phone: studentPhone, grade: studentGrade });
            
            // éªŒè¯è¡¨å•
            if (!studentName || !studentPhone || !studentGrade) {
                alert('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯');
                submitButton.disabled = false;
                submitButton.innerHTML = originalText;
                return;
            }

            // éªŒè¯æ‰‹æœºå·æ ¼å¼
            const phoneRegex = /^1[3-9]\d{9}$/;
            if (!phoneRegex.test(studentPhone)) {
                alert('è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·æ ¼å¼');
                submitButton.disabled = false;
                submitButton.innerHTML = originalText;
                return;
            }

            // æ£€æŸ¥æ˜¯å¦ä¸ºç‰¹æ®Šæµ‹è¯•æ‰‹æœºå·ï¼ˆå¯æ— é™æµ‹è¯•ï¼‰
            const isSpecialPhone = studentPhone === '15271226757';
            
            // å¦‚æœä¸æ˜¯ç‰¹æ®Šæ‰‹æœºå·ï¼Œéœ€è¦æ£€æŸ¥æ˜¯å¦å·²å®Œæˆæµ‹è¯•
            if (!isSpecialPhone && window.DatabaseOperations && window.supabaseClient && !skipDatabase) {
                try {
                    console.log('æ£€æŸ¥æ‰‹æœºå·æµ‹è¯•çŠ¶æ€...');
                    
                    // æ·»åŠ è¶…æ—¶åŒ…è£…å‡½æ•°
                    const withTimeout = (promise, seconds = 3) => {
                        return Promise.race([
                            promise,
                            new Promise((_, reject) => 
                                setTimeout(() => reject(new Error(`æ£€æŸ¥è¶…æ—¶ (${seconds}ç§’)`)), seconds * 1000)
                            )
                        ]);
                    };
                    
                    const testStatus = await withTimeout(DatabaseOperations.getUserTestStatus(studentPhone));
                    
                    if (testStatus && testStatus.has_completed_test) {
                        alert('è¯¥æ‰‹æœºå·å·²å®Œæˆæµ‹è¯•ï¼æ¯ä¸ªæ‰‹æœºå·åªèƒ½æµ‹è¯•ä¸€æ¬¡ã€‚\nå¦‚éœ€æŸ¥çœ‹æˆç»©ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ã€‚');
                        submitButton.disabled = false;
                        submitButton.innerHTML = originalText;
                        return;
                    }
                } catch (error) {
                    console.log('æ— æ³•æ£€æŸ¥æµ‹è¯•çŠ¶æ€ï¼Œå…è®¸ç»§ç»­:', error.message);
                    // å¦‚æœæ£€æŸ¥å¤±è´¥ï¼Œå…è®¸ç»§ç»­ï¼ˆé¿å…é˜»å¡ç”¨æˆ·ï¼‰
                }
            }
            
            // ä¿å­˜ç”¨æˆ·ä¿¡æ¯å¹¶è·³è½¬
            const userInfo = {
                name: studentName,
                phone: studentPhone,
                grade: studentGrade,
                testStartTime: new Date().toISOString(),
                isSpecialPhone: isSpecialPhone
            };
            
            localStorage.setItem('amc8_user_info', JSON.stringify(userInfo));
            localStorage.removeItem('amc8_test_answers');
            localStorage.removeItem('amc8_test_time');
            // ç¡®ä¿æ¸…é™¤æ‰€æœ‰æµ‹è¯•æ¨¡å¼æ ‡è®°
            testKeys.forEach(key => localStorage.removeItem(key));
            
            console.log(isSpecialPhone ? 'ç‰¹æ®Šæ‰‹æœºå· - å…è®¸æ— é™æµ‹è¯•:' : 'æ­£å¸¸æ¨¡å¼ - ä¿å­˜ç”¨æˆ·ä¿¡æ¯:', userInfo);
            
            // è·³è½¬åˆ°æµ‹è¯•é¡µé¢
            window.location.href = 'test.html';
            
            // åå°æ•°æ®åº“æ“ä½œï¼ˆä»…ä¸ºéç‰¹æ®Šæ‰‹æœºå·åˆ›å»ºç”¨æˆ·å’Œä¼šè¯ï¼‰
            if (!isSpecialPhone && window.DatabaseOperations && window.supabaseClient && !skipDatabase) {
                (async () => {
                    try {
                        console.log('åå°æ‰§è¡Œç”¨æˆ·åˆ›å»ºå’Œä¼šè¯ç®¡ç†...');
                        
                        // åˆ›å»ºæˆ–è·å–ç”¨æˆ·
                        const userResult = await DatabaseOperations.createOrGetUser(studentName, studentPhone, studentGrade);
                        
                        if (userResult.success) {
                            // æ›´æ–°localStorageä¸­çš„ç”¨æˆ·ID
                            const existingUserInfo = JSON.parse(localStorage.getItem('amc8_user_info') || '{}');
                            existingUserInfo.id = userResult.user.id;
                            localStorage.setItem('amc8_user_info', JSON.stringify(existingUserInfo));
                            
                            // åˆ›å»ºä¼šè¯
                            const sessionResult = await DatabaseOperations.getOrResumeSession(userResult.user.id);
                            if (sessionResult.success) {
                                localStorage.setItem('amc8_session_id', sessionResult.session.id);
                                console.log('åå°æ•°æ®åº“æ“ä½œå®Œæˆ');
                            }
                        }
                    } catch (error) {
                        console.error('åå°æ•°æ®åº“æ“ä½œå¤±è´¥:', error);
                    }
                })();
            }
        });

        // å¼€å‘è€…æµ‹è¯•æ¨¡å¼åŠŸèƒ½
        let isTestMode = false;
        let testModeActivated = false;
        const testModeToggle = document.getElementById('test-mode-toggle');
        const testModeContainer = document.getElementById('test-mode-toggle-container');
        const normalForm = document.getElementById('start-test-form');
        const testModeForm = document.getElementById('test-mode-form');

        // å¼€å‘è€…æ¨¡å¼æ¿€æ´»å‡½æ•°
        function enableTestMode() {
            if (window.testModeDisabled) {
                console.log('æµ‹è¯•æ¨¡å¼å·²è¢«ç¦ç”¨ï¼Œæ— æ³•æ¿€æ´»');
                return;
            }
            if (!testModeActivated) {
                testModeActivated = true;
                testModeContainer.style.display = 'flex';
                
                // æ˜¾ç¤ºå¼€å‘è€…æ¨¡å¼æ¨ªå¹…
                showDeveloperModeBanner();
                
                console.log('ğŸ§ª å¼€å‘è€…æµ‹è¯•æ¨¡å¼å·²æ¿€æ´»');
                console.log('æ¿€æ´»æ–¹å¼è¯´æ˜:');
                console.log('1. é”®ç›˜å¿«æ·é”®: Ctrl+Shift+T (Windows/Linux) æˆ– Cmd+Shift+T (Mac)');
                console.log('2. URLå‚æ•°: åœ¨ç½‘å€åæ·»åŠ  ?testmode=true');
                console.log('3. æ§åˆ¶å°å‘½ä»¤: enableTestMode()');
                console.log('4. éšè—è§¦å‘: å¿«é€Ÿç‚¹å‡»é¡µé¢æ ‡é¢˜5æ¬¡');
            }
        }

        // å…¨å±€æš´éœ²æ¿€æ´»å‡½æ•°ä¾›æ§åˆ¶å°ä½¿ç”¨
        window.enableTestMode = enableTestMode;
        
        // å…¨å±€æ¸…ç†å‡½æ•°ä¾›è°ƒè¯•ä½¿ç”¨
        window.clearAllAMC8Data = function() {
            const keys = Object.keys(localStorage).filter(key => key.startsWith('amc8_'));
            keys.forEach(key => localStorage.removeItem(key));
            console.log('å·²æ¸…é™¤æ‰€æœ‰AMC8ç›¸å…³æ•°æ®:', keys);
            window.testModeDisabled = false;
            window.location.reload();
        };

        // 1. é”®ç›˜å¿«æ·é”®æ¿€æ´» (Ctrl+Shift+T æˆ– Cmd+Shift+T)
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'T') {
                e.preventDefault();
                enableTestMode();
            }
        });

        // 2. URLå‚æ•°æ£€æµ‹
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('testmode') === 'true' && !window.testModeDisabled) {
            enableTestMode();
        }

        // 3. éšè—ç‚¹å‡»æ¿€æ´» (è¿ç»­ç‚¹å‡»æ ‡é¢˜5æ¬¡)
        let titleClickCount = 0;
        let titleClickTimer = null;
        const titleElement = document.querySelector('h2');
        
        if (titleElement) {
            titleElement.addEventListener('click', function() {
                titleClickCount++;
                
                if (titleClickCount === 1) {
                    titleClickTimer = setTimeout(() => {
                        titleClickCount = 0;
                    }, 3000); // 3ç§’å†…å®Œæˆ5æ¬¡ç‚¹å‡»
                }
                
                if (titleClickCount >= 5) {
                    clearTimeout(titleClickTimer);
                    titleClickCount = 0;
                    enableTestMode();
                }
            });
        }

        // æ˜¾ç¤ºå¼€å‘è€…æ¨¡å¼æ¨ªå¹…
        function showDeveloperModeBanner() {
            const banner = document.createElement('div');
            banner.id = 'developer-mode-banner';
            banner.className = 'fixed top-0 left-0 right-0 bg-gradient-to-r from-yellow-400 to-orange-500 text-white text-center py-2 px-4 z-50 shadow-lg';
            banner.innerHTML = `
                <div class="flex items-center justify-center space-x-2">
                    <i class="fas fa-code text-lg"></i>
                    <span class="font-bold">ğŸ§ª å¼€å‘è€…æµ‹è¯•æ¨¡å¼å·²æ¿€æ´»</span>
                    <i class="fas fa-flask text-lg"></i>
                    <button onclick="disableDeveloperMode()" class="ml-4 bg-white bg-opacity-20 hover:bg-opacity-30 px-2 py-1 rounded text-xs transition-all">
                        å…³é—­
                    </button>
                </div>
            `;
            
            document.body.insertBefore(banner, document.body.firstChild);
            
            // ä¸ºé¡µé¢æ·»åŠ é¡¶éƒ¨paddingä»¥é¿å…å†…å®¹è¢«æ¨ªå¹…é®æŒ¡
            document.body.style.paddingTop = '50px';
        }

        // å…³é—­å¼€å‘è€…æ¨¡å¼
        window.disableDeveloperMode = function() {
            testModeActivated = false;
            isTestMode = false;
            testModeContainer.style.display = 'none';
            normalForm.style.display = 'block';
            testModeForm.style.display = 'none';
            
            // ç§»é™¤æ¨ªå¹…
            const banner = document.getElementById('developer-mode-banner');
            if (banner) {
                banner.remove();
                document.body.style.paddingTop = '';
            }
            
            // é‡ç½®æŒ‰é’®çŠ¶æ€
            testModeToggle.innerHTML = '<i class="fas fa-flask mr-2"></i>ğŸ§ª å¼€å‘è€…æµ‹è¯•æ¨¡å¼';
            testModeToggle.className = 'px-4 py-2 text-sm bg-yellow-100 hover:bg-yellow-200 text-yellow-700 rounded-lg transition-all border-2 border-yellow-300';
            
            console.log('ğŸ”’ å¼€å‘è€…æµ‹è¯•æ¨¡å¼å·²å…³é—­');
        };

        // æµ‹è¯•æ¨¡å¼è¡¨å•åˆ‡æ¢é€»è¾‘
        testModeToggle.addEventListener('click', function() {
            if (!testModeActivated) return; // æœªæ¿€æ´»å¼€å‘è€…æ¨¡å¼æ—¶ä¸å…è®¸ä½¿ç”¨
            
            isTestMode = !isTestMode;
            window.testModeActive = isTestMode;  // å…¨å±€æ ‡è®°
            
            if (isTestMode) {
                normalForm.style.display = 'none';
                testModeForm.style.display = 'block';
                testModeToggle.innerHTML = '<i class="fas fa-times mr-2"></i>å…³é—­æµ‹è¯•è¡¨å•';
                testModeToggle.className = 'px-4 py-2 text-sm bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-all border-2 border-red-300';
                console.log('æµ‹è¯•æ¨¡å¼è¡¨å•å·²æ¿€æ´»');
            } else {
                normalForm.style.display = 'block';
                testModeForm.style.display = 'none';
                testModeToggle.innerHTML = '<i class="fas fa-flask mr-2"></i>ğŸ§ª å¼€å‘è€…æµ‹è¯•æ¨¡å¼';
                testModeToggle.className = 'px-4 py-2 text-sm bg-yellow-100 hover:bg-yellow-200 text-yellow-700 rounded-lg transition-all border-2 border-yellow-300';
                console.log('æµ‹è¯•æ¨¡å¼è¡¨å•å·²å…³é—­');
            }
        });

        // æµ‹è¯•æ¨¡å¼è¡¨å•æäº¤å¤„ç†
        testModeForm.addEventListener('submit', function(e) {
            e.preventDefault();
            e.stopPropagation();
            
            // ç¡®ä¿æµ‹è¯•æ¨¡å¼å·²æ¿€æ´»ä¸”å¯è§
            if (!testModeActivated || testModeForm.style.display === 'none' || window.testModeDisabled) {
                console.log('é˜»æ­¢äº†æ— æ•ˆçš„æµ‹è¯•æ¨¡å¼è¡¨å•æäº¤');
                return;
            }
            
            const submitButton = e.target.querySelector('button[type="submit"]');
            const originalText = submitButton.innerHTML;
            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>ç”Ÿæˆæµ‹è¯•æ•°æ®...';
            
            // è·å–æµ‹è¯•ç”¨æˆ·ä¿¡æ¯
            const testName = document.getElementById('test-student-name').value.trim();
            const testPhone = document.getElementById('test-student-phone').value.trim();
            const testGrade = document.getElementById('test-student-grade').value;
            const answerMode = document.getElementById('answer-mode').value;
            const answerCount = parseInt(document.getElementById('answer-count').value);
            
            // ç”Ÿæˆéšæœºç­”æ¡ˆ
            const testAnswers = generateTestAnswers(answerMode, answerCount);
            
            // ä¿å­˜æµ‹è¯•ç”¨æˆ·ä¿¡æ¯
            const userInfo = {
                name: testName,
                phone: testPhone,
                grade: testGrade,
                testStartTime: new Date().toISOString(),
                isTestMode: true,
                answerMode: answerMode,
                answerCount: answerCount
            };
            
            localStorage.setItem('amc8_user_info', JSON.stringify(userInfo));
            localStorage.setItem('amc8_test_answers', JSON.stringify(testAnswers));
            localStorage.setItem('amc8_test_mode', 'true');
            
            // æ¨¡æ‹Ÿæµ‹è¯•å®Œæˆæ—¶é—´ (ç«‹å³å®Œæˆ)
            localStorage.setItem('amc8_test_completed', 'true');
            
            setTimeout(() => {
                // ç›´æ¥è·³è½¬åˆ°ç»“æœé¡µé¢
                window.location.href = 'result.html';
            }, 1000);
        });

        // ç”Ÿæˆæµ‹è¯•ç­”æ¡ˆçš„å‡½æ•°
        function generateTestAnswers(mode, count) {
            const answers = {};
            const options = ['A', 'B', 'C', 'D', 'E'];
            
            // é¢„è®¾çš„æ­£ç¡®ç­”æ¡ˆ (åŸºäºå®é™…é¢˜ç›®)
            const correctAnswers = {
                1: 'E', 2: 'C', 3: 'D', 4: 'B', 5: 'A',
                6: 'E', 7: 'C', 8: 'D', 9: 'B', 10: 'A',
                11: 'C', 12: 'A', 13: 'E', 14: 'D', 15: 'C',
                16: 'B', 17: 'A', 18: 'E', 19: 'D', 20: 'C',
                21: 'B', 22: 'A', 23: 'E', 24: 'D', 25: 'C'
            };
            
            for (let i = 1; i <= count; i++) {
                let answer;
                
                switch (mode) {
                    case 'random':
                        answer = options[Math.floor(Math.random() * options.length)];
                        break;
                    case 'mostly-correct':
                        // 80% æ­£ç¡®ç‡
                        answer = Math.random() < 0.8 ? correctAnswers[i] : options[Math.floor(Math.random() * options.length)];
                        break;
                    case 'mostly-wrong':
                        // 20% æ­£ç¡®ç‡
                        answer = Math.random() < 0.2 ? correctAnswers[i] : options[Math.floor(Math.random() * options.length)];
                        break;
                    case 'all-correct':
                        answer = correctAnswers[i];
                        break;
                    case 'all-wrong':
                        // ç¡®ä¿é€‰æ‹©é”™è¯¯ç­”æ¡ˆ
                        do {
                            answer = options[Math.floor(Math.random() * options.length)];
                        } while (answer === correctAnswers[i]);
                        break;
                    case 'pattern':
                        // A-B-C-D-E å¾ªç¯
                        answer = options[(i - 1) % options.length];
                        break;
                    case 'no-answers':
                        // ä¸æ·»åŠ ä»»ä½•ç­”æ¡ˆï¼Œç›´æ¥è·³è¿‡
                        continue;
                    default:
                        answer = options[Math.floor(Math.random() * options.length)];
                }
                
                answers[i] = answer;
            }
            
            return answers;
        }

        // é¡µé¢åŠ è½½åŠ¨ç”»
        document.addEventListener('DOMContentLoaded', function() {
            const animatedElements = document.querySelectorAll('.animate-fade-in-up');
            animatedElements.forEach((element, index) => {
                element.style.opacity = '0';
                setTimeout(() => {
                    element.style.opacity = '1';
                }, index * 200);
            });
        });
    </script>
</body>
</html>